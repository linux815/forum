<?phpnamespace App;class MessageController extends BaseController{    protected ?array $user = [];    private $tex;    private $titl;    private $name;    private $surname;    private $t;    private $t2;    private $tx;    protected function OnInput(): void    {        parent::OnInput();        $this->title .= ' :: Мои сообщения';        // Получаем инстанс менеджера пользователей        $mUsers = Users::Instance();        // Очистка старых сессий        $mUsers->ClearSessions();        // Текущий пользователь        $this->user = $mUsers->Get();        $this->t = $mUsers->Message();        $this->t2 = $mUsers->Message2();        // Обработка просмотра сообщения по id        if (isset($_GET['id'])) {            $id_message = (int)$_GET['id'];            $row = $mUsers->message_select($id_message)->fetch();            if ($row) {                $this->name = $row['name'] ?? '';                $this->surname = $row['surname'] ?? '';                $this->titl = ($row['take_count'] > 0)                    ? "RE({$row['take_count']}){$row['title']}"                    : $row['title'];                $this->tex = $row['content'] ?? '';            }        }        // Обработка удаления сообщения        if (isset($_GET['delete'])) {            $id_message = (int)$_GET['delete'];            $mUsers->message_delete($id_message);            header('Location: index.php?c=mail');            exit;        }        // Обработка отправки формы ответа        if ($_SERVER['REQUEST_METHOD'] === 'POST' && !empty($_POST['submitForm'])) {            // Чтобы не было ошибки — нужно получить $row, например, по id из POST или GET            // В твоём исходном коде $row не определён здесь. Исправляю:            $id_message = isset($_POST['message_id']) ? (int)$_POST['message_id'] : 0;            $row = $mUsers->message_select($id_message)->fetch();            if ($row) {                $title = $row['title'];                $content = $_POST['text'] ?? '';                $send_count = ($row['send_count'] ?? 0) + 1;                $take_count = ($row['take_count'] ?? 0) + 2;                $mUsers->message_insert(                    $this->user['id_user'],                    $row['id_user'],                    $content,                    $title,                    $send_count,                    $take_count,                );            }        }    }    protected function OnOutput(): void    {        $vars = [            'title' => $this->titl ?? '',            'tex' => $this->tex ?? '',            'user' => $this->user ?? null,            't' => $this->t ?? null,            'tx' => $this->tx ?? null,            'name' => $this->name ?? '',            'surname' => $this->surname ?? '',            't2' => $this->t2 ?? null,        ];        $this->content = $this->Template('templates/v_message.php', $vars);        parent::OnOutput();    }}